---
source: crates/runtime/benches/bench.rs
description: "Query: select  *\nfrom (select avg(ss_list_price) B1_LP\n            ,count(ss_list_price) B1_CNT\n            ,count(distinct ss_list_price) B1_CNTD\n      from store_sales\n      where ss_quantity between 0 and 5\n        and (ss_list_price between 28 and 28+10\n             or ss_coupon_amt between 12573 and 12573+1000\n             or ss_wholesale_cost between 33 and 33+20)) B1,\n     (select avg(ss_list_price) B2_LP\n            ,count(ss_list_price) B2_CNT\n            ,count(distinct ss_list_price) B2_CNTD\n      from store_sales\n      where ss_quantity between 6 and 10\n        and (ss_list_price between 143 and 143+10\n          or ss_coupon_amt between 5562 and 5562+1000\n          or ss_wholesale_cost between 45 and 45+20)) B2,\n     (select avg(ss_list_price) B3_LP\n            ,count(ss_list_price) B3_CNT\n            ,count(distinct ss_list_price) B3_CNTD\n      from store_sales\n      where ss_quantity between 11 and 15\n        and (ss_list_price between 159 and 159+10\n          or ss_coupon_amt between 2807 and 2807+1000\n          or ss_wholesale_cost between 24 and 24+20)) B3,\n     (select avg(ss_list_price) B4_LP\n            ,count(ss_list_price) B4_CNT\n            ,count(distinct ss_list_price) B4_CNTD\n      from store_sales\n      where ss_quantity between 16 and 20\n        and (ss_list_price between 24 and 24+10\n          or ss_coupon_amt between 3706 and 3706+1000\n          or ss_wholesale_cost between 46 and 46+20)) B4,\n     (select avg(ss_list_price) B5_LP\n            ,count(ss_list_price) B5_CNT\n            ,count(distinct ss_list_price) B5_CNTD\n      from store_sales\n      where ss_quantity between 21 and 25\n        and (ss_list_price between 76 and 76+10\n          or ss_coupon_amt between 2096 and 2096+1000\n          or ss_wholesale_cost between 50 and 50+20)) B5,\n     (select avg(ss_list_price) B6_LP\n            ,count(ss_list_price) B6_CNT\n            ,count(distinct ss_list_price) B6_CNTD\n      from store_sales\n      where ss_quantity between 26 and 30\n        and (ss_list_price between 169 and 169+10\n          or ss_coupon_amt between 10672 and 10672+1000\n          or ss_wholesale_cost between 58 and 58+20)) B6\n LIMIT 100;\n"
snapshot_kind: text
---
+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| plan_type     | plan                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| logical_plan  | Limit: skip=0, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |   Cross Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |     Limit: skip=0, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |       Cross Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |         Limit: skip=0, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |           Cross Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |             Limit: skip=0, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |               Cross Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                 Limit: skip=0, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                   Cross Join:                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                     SubqueryAlias: b1                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                       Projection: avg(store_sales.ss_list_price) AS b1_lp, count(store_sales.ss_list_price) AS b1_cnt, count(DISTINCT store_sales.ss_list_price) AS b1_cntd                                                                                                                                                                                                                                                                                                                                |
|               |                         Limit: skip=0, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                           Aggregate: groupBy=[[]], aggr=[[avg(store_sales.ss_list_price), count(store_sales.ss_list_price), count(DISTINCT store_sales.ss_list_price)]]                                                                                                                                                                                                                                                                                                                                    |
|               |                             Projection: store_sales.ss_list_price                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                 Filter: store_sales.ss_quantity >= Int32(0) AND store_sales.ss_quantity <= Int32(5) AND (store_sales.ss_list_price >= Decimal128(Some(2800),7,2) AND store_sales.ss_list_price <= Decimal128(Some(3800),7,2) OR store_sales.ss_coupon_amt >= Decimal128(Some(1257300),7,2) AND store_sales.ss_coupon_amt <= Decimal128(Some(1357300),7,2) OR store_sales.ss_wholesale_cost >= Decimal128(Some(3300),7,2) AND store_sales.ss_wholesale_cost <= Decimal128(Some(5300),7,2))  |
|               |                                   TableScan: store_sales projection=[ss_quantity, ss_wholesale_cost, ss_list_price, ss_coupon_amt]                                                                                                                                                                                                                                                                                                                                                                         |
|               |                     SubqueryAlias: b2                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                       Projection: avg(store_sales.ss_list_price) AS b2_lp, count(store_sales.ss_list_price) AS b2_cnt, count(DISTINCT store_sales.ss_list_price) AS b2_cntd                                                                                                                                                                                                                                                                                                                                |
|               |                         Limit: skip=0, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                           Aggregate: groupBy=[[]], aggr=[[avg(store_sales.ss_list_price), count(store_sales.ss_list_price), count(DISTINCT store_sales.ss_list_price)]]                                                                                                                                                                                                                                                                                                                                    |
|               |                             Projection: store_sales.ss_list_price                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                 Filter: store_sales.ss_quantity >= Int32(6) AND store_sales.ss_quantity <= Int32(10) AND (store_sales.ss_list_price >= Decimal128(Some(14300),7,2) AND store_sales.ss_list_price <= Decimal128(Some(15300),7,2) OR store_sales.ss_coupon_amt >= Decimal128(Some(556200),7,2) AND store_sales.ss_coupon_amt <= Decimal128(Some(656200),7,2) OR store_sales.ss_wholesale_cost >= Decimal128(Some(4500),7,2) AND store_sales.ss_wholesale_cost <= Decimal128(Some(6500),7,2)) |
|               |                                   TableScan: store_sales projection=[ss_quantity, ss_wholesale_cost, ss_list_price, ss_coupon_amt]                                                                                                                                                                                                                                                                                                                                                                         |
|               |                 SubqueryAlias: b3                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                   Projection: avg(store_sales.ss_list_price) AS b3_lp, count(store_sales.ss_list_price) AS b3_cnt, count(DISTINCT store_sales.ss_list_price) AS b3_cntd                                                                                                                                                                                                                                                                                                                                    |
|               |                     Limit: skip=0, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                       Aggregate: groupBy=[[]], aggr=[[avg(store_sales.ss_list_price), count(store_sales.ss_list_price), count(DISTINCT store_sales.ss_list_price)]]                                                                                                                                                                                                                                                                                                                                        |
|               |                         Projection: store_sales.ss_list_price                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                           BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                             Filter: store_sales.ss_quantity >= Int32(11) AND store_sales.ss_quantity <= Int32(15) AND (store_sales.ss_list_price >= Decimal128(Some(15900),7,2) AND store_sales.ss_list_price <= Decimal128(Some(16900),7,2) OR store_sales.ss_coupon_amt >= Decimal128(Some(280700),7,2) AND store_sales.ss_coupon_amt <= Decimal128(Some(380700),7,2) OR store_sales.ss_wholesale_cost >= Decimal128(Some(2400),7,2) AND store_sales.ss_wholesale_cost <= Decimal128(Some(4400),7,2))    |
|               |                               TableScan: store_sales projection=[ss_quantity, ss_wholesale_cost, ss_list_price, ss_coupon_amt]                                                                                                                                                                                                                                                                                                                                                                             |
|               |             SubqueryAlias: b4                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |               Projection: avg(store_sales.ss_list_price) AS b4_lp, count(store_sales.ss_list_price) AS b4_cnt, count(DISTINCT store_sales.ss_list_price) AS b4_cntd                                                                                                                                                                                                                                                                                                                                        |
|               |                 Limit: skip=0, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                   Aggregate: groupBy=[[]], aggr=[[avg(store_sales.ss_list_price), count(store_sales.ss_list_price), count(DISTINCT store_sales.ss_list_price)]]                                                                                                                                                                                                                                                                                                                                            |
|               |                     Projection: store_sales.ss_list_price                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                       BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                         Filter: store_sales.ss_quantity >= Int32(16) AND store_sales.ss_quantity <= Int32(20) AND (store_sales.ss_list_price >= Decimal128(Some(2400),7,2) AND store_sales.ss_list_price <= Decimal128(Some(3400),7,2) OR store_sales.ss_coupon_amt >= Decimal128(Some(370600),7,2) AND store_sales.ss_coupon_amt <= Decimal128(Some(470600),7,2) OR store_sales.ss_wholesale_cost >= Decimal128(Some(4600),7,2) AND store_sales.ss_wholesale_cost <= Decimal128(Some(6600),7,2))          |
|               |                           TableScan: store_sales projection=[ss_quantity, ss_wholesale_cost, ss_list_price, ss_coupon_amt]                                                                                                                                                                                                                                                                                                                                                                                 |
|               |         SubqueryAlias: b5                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |           Projection: avg(store_sales.ss_list_price) AS b5_lp, count(store_sales.ss_list_price) AS b5_cnt, count(DISTINCT store_sales.ss_list_price) AS b5_cntd                                                                                                                                                                                                                                                                                                                                            |
|               |             Limit: skip=0, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |               Aggregate: groupBy=[[]], aggr=[[avg(store_sales.ss_list_price), count(store_sales.ss_list_price), count(DISTINCT store_sales.ss_list_price)]]                                                                                                                                                                                                                                                                                                                                                |
|               |                 Projection: store_sales.ss_list_price                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                   BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                     Filter: store_sales.ss_quantity >= Int32(21) AND store_sales.ss_quantity <= Int32(25) AND (store_sales.ss_list_price >= Decimal128(Some(7600),7,2) AND store_sales.ss_list_price <= Decimal128(Some(8600),7,2) OR store_sales.ss_coupon_amt >= Decimal128(Some(209600),7,2) AND store_sales.ss_coupon_amt <= Decimal128(Some(309600),7,2) OR store_sales.ss_wholesale_cost >= Decimal128(Some(5000),7,2) AND store_sales.ss_wholesale_cost <= Decimal128(Some(7000),7,2))              |
|               |                       TableScan: store_sales projection=[ss_quantity, ss_wholesale_cost, ss_list_price, ss_coupon_amt]                                                                                                                                                                                                                                                                                                                                                                                     |
|               |     SubqueryAlias: b6                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |       Projection: avg(store_sales.ss_list_price) AS b6_lp, count(store_sales.ss_list_price) AS b6_cnt, count(DISTINCT store_sales.ss_list_price) AS b6_cntd                                                                                                                                                                                                                                                                                                                                                |
|               |         Limit: skip=0, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |           Aggregate: groupBy=[[]], aggr=[[avg(store_sales.ss_list_price), count(store_sales.ss_list_price), count(DISTINCT store_sales.ss_list_price)]]                                                                                                                                                                                                                                                                                                                                                    |
|               |             Projection: store_sales.ss_list_price                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |               BytesProcessedNode                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                 Filter: store_sales.ss_quantity >= Int32(26) AND store_sales.ss_quantity <= Int32(30) AND (store_sales.ss_list_price >= Decimal128(Some(16900),7,2) AND store_sales.ss_list_price <= Decimal128(Some(17900),7,2) OR store_sales.ss_coupon_amt >= Decimal128(Some(1067200),7,2) AND store_sales.ss_coupon_amt <= Decimal128(Some(1167200),7,2) OR store_sales.ss_wholesale_cost >= Decimal128(Some(5800),7,2) AND store_sales.ss_wholesale_cost <= Decimal128(Some(7800),7,2))              |
|               |                   TableScan: store_sales projection=[ss_quantity, ss_wholesale_cost, ss_list_price, ss_coupon_amt]                                                                                                                                                                                                                                                                                                                                                                                         |
| physical_plan | ProjectionExec: expr=[b1_lp@3 as b1_lp, b1_cnt@4 as b1_cnt, b1_cntd@5 as b1_cntd, b2_lp@6 as b2_lp, b2_cnt@7 as b2_cnt, b2_cntd@8 as b2_cntd, b3_lp@9 as b3_lp, b3_cnt@10 as b3_cnt, b3_cntd@11 as b3_cntd, b4_lp@12 as b4_lp, b4_cnt@13 as b4_cnt, b4_cntd@14 as b4_cntd, b5_lp@15 as b5_lp, b5_cnt@16 as b5_cnt, b5_cntd@17 as b5_cntd, b6_lp@0 as b6_lp, b6_cnt@1 as b6_cnt, b6_cntd@2 as b6_cntd]                                                                                                      |
|               |   GlobalLimitExec: skip=0, fetch=100                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |     CrossJoinExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |       ProjectionExec: expr=[avg(store_sales.ss_list_price)@0 as b6_lp, count(store_sales.ss_list_price)@1 as b6_cnt, count(DISTINCT store_sales.ss_list_price)@2 as b6_cntd]                                                                                                                                                                                                                                                                                                                               |
|               |         AggregateExec: mode=Final, gby=[], aggr=[avg(store_sales.ss_list_price), count(store_sales.ss_list_price), count(DISTINCT store_sales.ss_list_price)]                                                                                                                                                                                                                                                                                                                                              |
|               |           CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |             AggregateExec: mode=Partial, gby=[], aggr=[avg(store_sales.ss_list_price), count(store_sales.ss_list_price), count(DISTINCT store_sales.ss_list_price)]                                                                                                                                                                                                                                                                                                                                        |
|               |               ProjectionExec: expr=[ss_list_price@2 as ss_list_price]                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                 BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                         |
|               |                   CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                     FilterExec: ss_quantity@0 >= 26 AND ss_quantity@0 <= 30 AND (ss_list_price@2 >= Some(16900),7,2 AND ss_list_price@2 <= Some(17900),7,2 OR ss_coupon_amt@3 >= Some(1067200),7,2 AND ss_coupon_amt@3 <= Some(1167200),7,2 OR ss_wholesale_cost@1 >= Some(5800),7,2 AND ss_wholesale_cost@1 <= Some(7800),7,2)                                                                                                                                                                            |
|               |                       SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                         RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                           MemoryExec: partitions=1, partition_sizes=[352]                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |       ProjectionExec: expr=[b1_lp@3 as b1_lp, b1_cnt@4 as b1_cnt, b1_cntd@5 as b1_cntd, b2_lp@6 as b2_lp, b2_cnt@7 as b2_cnt, b2_cntd@8 as b2_cntd, b3_lp@9 as b3_lp, b3_cnt@10 as b3_cnt, b3_cntd@11 as b3_cntd, b4_lp@12 as b4_lp, b4_cnt@13 as b4_cnt, b4_cntd@14 as b4_cntd, b5_lp@0 as b5_lp, b5_cnt@1 as b5_cnt, b5_cntd@2 as b5_cntd]                                                                                                                                                               |
|               |         CrossJoinExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |           ProjectionExec: expr=[avg(store_sales.ss_list_price)@0 as b5_lp, count(store_sales.ss_list_price)@1 as b5_cnt, count(DISTINCT store_sales.ss_list_price)@2 as b5_cntd]                                                                                                                                                                                                                                                                                                                           |
|               |             AggregateExec: mode=Final, gby=[], aggr=[avg(store_sales.ss_list_price), count(store_sales.ss_list_price), count(DISTINCT store_sales.ss_list_price)]                                                                                                                                                                                                                                                                                                                                          |
|               |               CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                 AggregateExec: mode=Partial, gby=[], aggr=[avg(store_sales.ss_list_price), count(store_sales.ss_list_price), count(DISTINCT store_sales.ss_list_price)]                                                                                                                                                                                                                                                                                                                                    |
|               |                   ProjectionExec: expr=[ss_list_price@2 as ss_list_price]                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                     BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                       CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                         FilterExec: ss_quantity@0 >= 21 AND ss_quantity@0 <= 25 AND (ss_list_price@2 >= Some(7600),7,2 AND ss_list_price@2 <= Some(8600),7,2 OR ss_coupon_amt@3 >= Some(209600),7,2 AND ss_coupon_amt@3 <= Some(309600),7,2 OR ss_wholesale_cost@1 >= Some(5000),7,2 AND ss_wholesale_cost@1 <= Some(7000),7,2)                                                                                                                                                                            |
|               |                           SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                             RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                               MemoryExec: partitions=1, partition_sizes=[352]                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |           ProjectionExec: expr=[b1_lp@3 as b1_lp, b1_cnt@4 as b1_cnt, b1_cntd@5 as b1_cntd, b2_lp@6 as b2_lp, b2_cnt@7 as b2_cnt, b2_cntd@8 as b2_cntd, b3_lp@9 as b3_lp, b3_cnt@10 as b3_cnt, b3_cntd@11 as b3_cntd, b4_lp@0 as b4_lp, b4_cnt@1 as b4_cnt, b4_cntd@2 as b4_cntd]                                                                                                                                                                                                                          |
|               |             CrossJoinExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |               ProjectionExec: expr=[avg(store_sales.ss_list_price)@0 as b4_lp, count(store_sales.ss_list_price)@1 as b4_cnt, count(DISTINCT store_sales.ss_list_price)@2 as b4_cntd]                                                                                                                                                                                                                                                                                                                       |
|               |                 AggregateExec: mode=Final, gby=[], aggr=[avg(store_sales.ss_list_price), count(store_sales.ss_list_price), count(DISTINCT store_sales.ss_list_price)]                                                                                                                                                                                                                                                                                                                                      |
|               |                   CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                     AggregateExec: mode=Partial, gby=[], aggr=[avg(store_sales.ss_list_price), count(store_sales.ss_list_price), count(DISTINCT store_sales.ss_list_price)]                                                                                                                                                                                                                                                                                                                                |
|               |                       ProjectionExec: expr=[ss_list_price@2 as ss_list_price]                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                         BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                           CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                             FilterExec: ss_quantity@0 >= 16 AND ss_quantity@0 <= 20 AND (ss_list_price@2 >= Some(2400),7,2 AND ss_list_price@2 <= Some(3400),7,2 OR ss_coupon_amt@3 >= Some(370600),7,2 AND ss_coupon_amt@3 <= Some(470600),7,2 OR ss_wholesale_cost@1 >= Some(4600),7,2 AND ss_wholesale_cost@1 <= Some(6600),7,2)                                                                                                                                                                        |
|               |                               SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                 RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                   MemoryExec: partitions=1, partition_sizes=[352]                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |               ProjectionExec: expr=[b1_lp@3 as b1_lp, b1_cnt@4 as b1_cnt, b1_cntd@5 as b1_cntd, b2_lp@6 as b2_lp, b2_cnt@7 as b2_cnt, b2_cntd@8 as b2_cntd, b3_lp@0 as b3_lp, b3_cnt@1 as b3_cnt, b3_cntd@2 as b3_cntd]                                                                                                                                                                                                                                                                                    |
|               |                 CrossJoinExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
|               |                   ProjectionExec: expr=[avg(store_sales.ss_list_price)@0 as b3_lp, count(store_sales.ss_list_price)@1 as b3_cnt, count(DISTINCT store_sales.ss_list_price)@2 as b3_cntd]                                                                                                                                                                                                                                                                                                                   |
|               |                     AggregateExec: mode=Final, gby=[], aggr=[avg(store_sales.ss_list_price), count(store_sales.ss_list_price), count(DISTINCT store_sales.ss_list_price)]                                                                                                                                                                                                                                                                                                                                  |
|               |                       CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|               |                         AggregateExec: mode=Partial, gby=[], aggr=[avg(store_sales.ss_list_price), count(store_sales.ss_list_price), count(DISTINCT store_sales.ss_list_price)]                                                                                                                                                                                                                                                                                                                            |
|               |                           ProjectionExec: expr=[ss_list_price@2 as ss_list_price]                                                                                                                                                                                                                                                                                                                                                                                                                          |
|               |                             BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                               CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|               |                                 FilterExec: ss_quantity@0 >= 11 AND ss_quantity@0 <= 15 AND (ss_list_price@2 >= Some(15900),7,2 AND ss_list_price@2 <= Some(16900),7,2 OR ss_coupon_amt@3 >= Some(280700),7,2 AND ss_coupon_amt@3 <= Some(380700),7,2 OR ss_wholesale_cost@1 >= Some(2400),7,2 AND ss_wholesale_cost@1 <= Some(4400),7,2)                                                                                                                                                                  |
|               |                                   SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|               |                                     RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                   |
|               |                                       MemoryExec: partitions=1, partition_sizes=[352]                                                                                                                                                                                                                                                                                                                                                                                                                      |
|               |                   CrossJoinExec                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|               |                     ProjectionExec: expr=[avg(store_sales.ss_list_price)@0 as b1_lp, count(store_sales.ss_list_price)@1 as b1_cnt, count(DISTINCT store_sales.ss_list_price)@2 as b1_cntd]                                                                                                                                                                                                                                                                                                                 |
|               |                       AggregateExec: mode=Final, gby=[], aggr=[avg(store_sales.ss_list_price), count(store_sales.ss_list_price), count(DISTINCT store_sales.ss_list_price)]                                                                                                                                                                                                                                                                                                                                |
|               |                         CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                           AggregateExec: mode=Partial, gby=[], aggr=[avg(store_sales.ss_list_price), count(store_sales.ss_list_price), count(DISTINCT store_sales.ss_list_price)]                                                                                                                                                                                                                                                                                                                          |
|               |                             ProjectionExec: expr=[ss_list_price@2 as ss_list_price]                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                               BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                   FilterExec: ss_quantity@0 >= 0 AND ss_quantity@0 <= 5 AND (ss_list_price@2 >= Some(2800),7,2 AND ss_list_price@2 <= Some(3800),7,2 OR ss_coupon_amt@3 >= Some(1257300),7,2 AND ss_coupon_amt@3 <= Some(1357300),7,2 OR ss_wholesale_cost@1 >= Some(3300),7,2 AND ss_wholesale_cost@1 <= Some(5300),7,2)                                                                                                                                                                  |
|               |                                     SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                       RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                         MemoryExec: partitions=1, partition_sizes=[352]                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                     ProjectionExec: expr=[avg(store_sales.ss_list_price)@0 as b2_lp, count(store_sales.ss_list_price)@1 as b2_cnt, count(DISTINCT store_sales.ss_list_price)@2 as b2_cntd]                                                                                                                                                                                                                                                                                                                 |
|               |                       AggregateExec: mode=Final, gby=[], aggr=[avg(store_sales.ss_list_price), count(store_sales.ss_list_price), count(DISTINCT store_sales.ss_list_price)]                                                                                                                                                                                                                                                                                                                                |
|               |                         CoalescePartitionsExec                                                                                                                                                                                                                                                                                                                                                                                                                                                             |
|               |                           AggregateExec: mode=Partial, gby=[], aggr=[avg(store_sales.ss_list_price), count(store_sales.ss_list_price), count(DISTINCT store_sales.ss_list_price)]                                                                                                                                                                                                                                                                                                                          |
|               |                             ProjectionExec: expr=[ss_list_price@2 as ss_list_price]                                                                                                                                                                                                                                                                                                                                                                                                                        |
|               |                               BytesProcessedExec                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|               |                                 CoalesceBatchesExec: target_batch_size=8192                                                                                                                                                                                                                                                                                                                                                                                                                                |
|               |                                   FilterExec: ss_quantity@0 >= 6 AND ss_quantity@0 <= 10 AND (ss_list_price@2 >= Some(14300),7,2 AND ss_list_price@2 <= Some(15300),7,2 OR ss_coupon_amt@3 >= Some(556200),7,2 AND ss_coupon_amt@3 <= Some(656200),7,2 OR ss_wholesale_cost@1 >= Some(4500),7,2 AND ss_wholesale_cost@1 <= Some(6500),7,2)                                                                                                                                                                 |
|               |                                     SchemaCastScanExec                                                                                                                                                                                                                                                                                                                                                                                                                                                     |
|               |                                       RepartitionExec: partitioning=RoundRobinBatch(4), input_partitions=1                                                                                                                                                                                                                                                                                                                                                                                                 |
|               |                                         MemoryExec: partitions=1, partition_sizes=[352]                                                                                                                                                                                                                                                                                                                                                                                                                    |
|               |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
+---------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
